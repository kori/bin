#!/bin/sh
# panel script

. $XDG_CONFIG_HOME/wm.conf


# set colors
ffg='%{F#ff839496}'
bfg='%{B#ff839496}'
fhl='%{F#ff58698c}'
bhl='%{B#ff58698c}'
flw='%{F#ff353540}'
fbg='%{F#ff09090d}'
bbg='%{B#ff09090d}'
sep="${flw} │ ${ffg}"

# workspace indicators
wi() {
	for i in $(wsm status); do
		echo $i | while IFS=: read ws st; do
			case $st in
				0) echo -n "$flw" ;;
				1) echo -n "$fhl" ;;
			esac
			case $ws in
				1) echo -n "main" ;;
				2) echo -n "www" ;;
				3) echo -n "steam" ;;
				4) echo -n "null" ;;
				5) echo -n "void" ;;
			esac
			echo -n $bbg$ffg
			echo -n ' '
		done
	done
}

# invoke panel
while :; do
	# set bg/fg
	bar="$ffg$bbg"

	# left section
	bar="$bar %{l}"
	# window groups
	bar="$bar $(wi)"

	# music

	# center section
	#bar="$bar %{c}"

	# right section
	bar="$bar %{r}"
	bar="$bar${fhl}♫"
	bar="$bar ${ffg}$(mpc current)${fbg}"
	bar="$bar$sep"
	# cpu
	bar="$bar${fhl}${ffg}"
	bar="$bar $(cpu)%"
	bar="$bar$sep"
	# memory
	bar="$bar${fhl}${ffg}"
	bar="$bar $(memory)"
	bar="$bar$sep"
	# volume
	bar="$bar${fhl}${ffg}"
	bar="$bar $(volume | sed 1q)%"
	bar="$bar$sep"
	# clock
	bar="$bar${fhl}${bbg}"
	bar="$bar ${ffg}$(date '+%T')"

	echo "$bar "
	sleep 0.25;
done | lemonbar -g "$(wattr w $(lsw -r))x${PANELHEIGHT}x0x0" -d \
                -f 'Metis:pixelsize=8' -f 'kochigothic:size=8'
